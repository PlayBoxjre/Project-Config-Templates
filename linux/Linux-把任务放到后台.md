# Linux-把任务放到后台

原创 2016年11月08日 09:37:09

- **3768

公司用的服务器，只能ssh远程操作，每天都会自动退出账户，不知道怎么回事儿，很郁闷。所以每天早起重新登录后发现进程已经关闭了，因为你运行的任务是和terminal关联在一起的，terminal关闭后，你运行的任务自然就关闭了。为了避免此事件发生，需要把任务放到后台运行，方法如下：

## **1.nohup命令**

```
nohup command &1
```

如果使用了nohup命令，在缺省情况下，该作业的所有输出都被重定向到一个名为nohup.out的文件中，除非另外指定了输出文件：

```
nohup command>myout.file 2>&1 &1
```

这样command的所有输出就被定向到了myout.file

## **2.ps命令**

ps命令用于查看系统上运行的进程，例如

```
  PID TTY          TIME CMD
 7016 pts/1    00:00:00 bash
10913 pts/1    00:07:43 python
11006 pts/1    00:00:00 ps1234
```

可以知道，我运行的程序PID是10913，默认指令`$ps` 是和终端绑定在一起的，也就是说`$ps` 指令只显示有控制终端的进程，要想显示没有控制终端的进程，可以使用以下命令：

```
$ ps -x1
```

ps的其他参数请自行man，或者查看该篇帖子[10个重要的Linux ps命令实战](https://linux.cn/article-4743-1.html) 
如果想实时观测CPU运行状态，可以使用`$top` 指令，具体参考[每天一个linux命令（44）：top命令](http://www.cnblogs.com/peida/archive/2012/12/24/2831353.html)

## **3.kill命令**

输入如下命令即可杀死进程

```
kill 109131
```

有时候可能会遇到这样的情况，某个进程已经挂死或闲置，使用kill命令却杀不掉。这时候就必须发送信号9，强行关闭此进程。当然这种“野蛮”的方法很可能会导致打开的文件出现错误或者数据丢失之类的错误。所以不到万不得已不要使用强制结束的办法。如果连信号9都不响应，那恐怕就只有重新启动计算机了。

**

## **4.补充几个相关指令：**

** 
[引用自](http://blog.chinaunix.net/uid-26785297-id-3375270.html) 
fg、bg、jobs、&、nohup、ctrl + z命令

```
&1
```

加在一个命令的最后，可以把这个命令放到后台执行,如gftp &,

```
ctrl + z1
```

可以将一个正在前台执行的命令放到后台，并且处于暂停状态，不

```
jobs1
```

前有多少在后台运行的命令 
jobs -l选项可显示所有任务的PID，jobs的状态可以是running, stopped, Terminated,但是如果任务被终止了（kill），shell 从当前的shell环境已知的列表中删除任务的进程标识；也就是说，jobs命令显示的是当前shell环境中所起的后台正在运行或者被挂起的任务信息；

```
fg1
```

将后台中的命令调至前台继续运行 
如果后台中有多个命令，可以用`fg %jobnumber`将选中的命令调出，%jobnumber是通过jobs命令查到的后台正在执行的命令的序号(不是pid)

```
bg1
```

将一个在后台暂停的命令，变成继续执行 （在后台执行） 
如果后台中有多个命令，可以用`bg %jobnumber`将选中的命令调出，%jobnumber是通过jobs命令查到的后台正在执行的命令的序号(不是pid)

将任务转移到后台运行： 
先`ctrl + z`；再`bg %jobnumber`，这样进程就被移到后台运行，终端还能继续接受命令。

**概念：当前任务** 
如果后台的任务号有2个，[1],[2]；如果当第一个后台任务顺利执行完毕，第二个后台任务还在执行中时，当前任务便会自动变成后台任务号码“[2]” 的后台任务。所以可以得出一点，即当前任务是会变动的。当用户输入“fg”、“bg”和“stop”等命令时，如果不加任何引号，则所变动的均是当前任务